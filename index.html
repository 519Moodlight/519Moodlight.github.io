
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>ESE 519Moodlight</title><style>
    /* cspell:disable-file */
    /* webkit printing magic: print all background colors */
    html {
        -webkit-print-color-adjust: exact;
    }
    * {
        box-sizing: border-box;
        -webkit-print-color-adjust: exact;
    }
    
    html,
    body {
        margin: 0;
        padding: 0;
    }
    @media only screen {
        body {
            margin: 2em auto;
            max-width: 900px;
            color: rgb(55, 53, 47);
        }
    }
    
    body {
        line-height: 1.5;
        white-space: pre-wrap;
    }
    
    a,
    a.visited {
        color: inherit;
        text-decoration: underline;
    }
    
    .pdf-relative-link-path {
        font-size: 80%;
        color: #444;
    }
    
    h1,
    h2,
    h3 {
        letter-spacing: -0.01em;
        line-height: 1.2;
        font-weight: 600;
        margin-bottom: 0;
    }
    
    .page-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-top: 0;
        margin-bottom: 0.75em;
    }
    
    h1 {
        font-size: 1.875rem;
        margin-top: 1.875rem;
    }
    
    h2 {
        font-size: 1.5rem;
        margin-top: 1.5rem;
    }
    
    h3 {
        font-size: 1.25rem;
        margin-top: 1.25rem;
    }
    
    .source {
        border: 1px solid #ddd;
        border-radius: 3px;
        padding: 1.5em;
        word-break: break-all;
    }
    
    .callout {
        border-radius: 3px;
        padding: 1rem;
    }
    
    figure {
        margin: 1.25em 0;
        page-break-inside: avoid;
    }
    
    figcaption {
        opacity: 0.5;
        font-size: 85%;
        margin-top: 0.5em;
    }
    
    mark {
        background-color: transparent;
    }
    
    .indented {
        padding-left: 1.5em;
    }
    
    hr {
        background: transparent;
        display: block;
        width: 100%;
        height: 1px;
        visibility: visible;
        border: none;
        border-bottom: 1px solid rgba(55, 53, 47, 0.09);
    }
    
    img {
        max-width: 100%;
    }
    
    @media only print {
        img {
            max-height: 100vh;
            object-fit: contain;
        }
    }
    
    @page {
        margin: 1in;
    }
    
    .collection-content {
        font-size: 0.875rem;
    }
    
    .column-list {
        display: flex;
        justify-content: space-between;
    }
    
    .column {
        padding: 0 1em;
    }
    
    .column:first-child {
        padding-left: 0;
    }
    
    .column:last-child {
        padding-right: 0;
    }
    
    .table_of_contents-item {
        display: block;
        font-size: 0.875rem;
        line-height: 1.3;
        padding: 0.125rem;
    }
    
    .table_of_contents-indent-1 {
        margin-left: 1.5rem;
    }
    
    .table_of_contents-indent-2 {
        margin-left: 3rem;
    }
    
    .table_of_contents-indent-3 {
        margin-left: 4.5rem;
    }
    
    .table_of_contents-link {
        text-decoration: none;
        opacity: 0.7;
        border-bottom: 1px solid rgba(55, 53, 47, 0.18);
    }
    
    table,
    th,
    td {
        border: 1px solid rgba(55, 53, 47, 0.09);
        border-collapse: collapse;
    }
    
    table {
        border-left: none;
        border-right: none;
    }
    
    th,
    td {
        font-weight: normal;
        padding: 0.25em 0.5em;
        line-height: 1.5;
        min-height: 1.5em;
        text-align: left;
    }
    
    th {
        color: rgba(55, 53, 47, 0.6);
    }
    
    ol,
    ul {
        margin: 0;
        margin-block-start: 0.6em;
        margin-block-end: 0.6em;
    }
    
    li > ol:first-child,
    li > ul:first-child {
        margin-block-start: 0.6em;
    }
    
    ul > li {
        list-style: disc;
    }
    
    ul.to-do-list {
        text-indent: -1.7em;
    }
    
    ul.to-do-list > li {
        list-style: none;
    }
    
    .to-do-children-checked {
        text-decoration: line-through;
        opacity: 0.375;
    }
    
    ul.toggle > li {
        list-style: none;
    }
    
    ul {
        padding-inline-start: 1.7em;
    }
    
    ul > li {
        padding-left: 0.1em;
    }
    
    ol {
        padding-inline-start: 1.6em;
    }
    
    ol > li {
        padding-left: 0.2em;
    }
    
    .mono ol {
        padding-inline-start: 2em;
    }
    
    .mono ol > li {
        text-indent: -0.4em;
    }
    
    .toggle {
        padding-inline-start: 0em;
        list-style-type: none;
    }
    
    /* Indent toggle children */
    .toggle > li > details {
        padding-left: 1.7em;
    }
    
    .toggle > li > details > summary {
        margin-left: -1.1em;
    }
    
    .selected-value {
        display: inline-block;
        padding: 0 0.5em;
        background: rgba(206, 205, 202, 0.5);
        border-radius: 3px;
        margin-right: 0.5em;
        margin-top: 0.3em;
        margin-bottom: 0.3em;
        white-space: nowrap;
    }
    
    .collection-title {
        display: inline-block;
        margin-right: 1em;
    }
    
    .simple-table {
        margin-top: 1em;
        font-size: 0.875rem;
        empty-cells: show;
    }
    .simple-table td {
        height: 29px;
        min-width: 120px;
    }
    
    .simple-table th {
        height: 29px;
        min-width: 120px;
    }
    
    .simple-table-header-color {
        background: rgb(247, 246, 243);
        color: black;
    }
    .simple-table-header {
        font-weight: 500;
    }
    
    time {
        opacity: 0.5;
    }
    
    .icon {
        display: inline-block;
        max-width: 1.2em;
        max-height: 1.2em;
        text-decoration: none;
        vertical-align: text-bottom;
        margin-right: 0.5em;
    }
    
    img.icon {
        border-radius: 3px;
    }
    
    .user-icon {
        width: 1.5em;
        height: 1.5em;
        border-radius: 100%;
        margin-right: 0.5rem;
    }
    
    .user-icon-inner {
        font-size: 0.8em;
    }
    
    .text-icon {
        border: 1px solid #000;
        text-align: center;
    }
    
    .page-cover-image {
        display: block;
        object-fit: cover;
        width: 100%;
        max-height: 30vh;
    }
    
    .page-header-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }
    
    .page-header-icon-with-cover {
        margin-top: -0.72em;
        margin-left: 0.07em;
    }
    
    .page-header-icon img {
        border-radius: 3px;
    }
    
    .link-to-page {
        margin: 1em 0;
        padding: 0;
        border: none;
        font-weight: 500;
    }
    
    p > .user {
        opacity: 0.5;
    }
    
    td > .user,
    td > time {
        white-space: nowrap;
    }
    
    input[type="checkbox"] {
        transform: scale(1.5);
        margin-right: 0.6em;
        vertical-align: middle;
    }
    
    p {
        margin-top: 0.5em;
        margin-bottom: 0.5em;
    }
    
    .image {
        border: none;
        margin: 1.5em 0;
        padding: 0;
        border-radius: 0;
        text-align: center;
    }
    
    .code,
    code {
        background: rgba(135, 131, 120, 0.15);
        border-radius: 3px;
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-size: 85%;
        tab-size: 2;
    }
    
    code {
        color: #eb5757;
    }
    
    .code {
        padding: 1.5em 1em;
    }
    
    .code-wrap {
        white-space: pre-wrap;
        word-break: break-all;
    }
    
    .code > code {
        background: none;
        padding: 0;
        font-size: 100%;
        color: inherit;
    }
    
    blockquote {
        font-size: 1.25em;
        margin: 1em 0;
        padding-left: 1em;
        border-left: 3px solid rgb(55, 53, 47);
    }
    
    .bookmark {
        text-decoration: none;
        max-height: 8em;
        padding: 0;
        display: flex;
        width: 100%;
        align-items: stretch;
    }
    
    .bookmark-title {
        font-size: 0.85em;
        overflow: hidden;
        text-overflow: ellipsis;
        height: 1.75em;
        white-space: nowrap;
    }
    
    .bookmark-text {
        display: flex;
        flex-direction: column;
    }
    
    .bookmark-info {
        flex: 4 1 180px;
        padding: 12px 14px 14px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    
    .bookmark-image {
        width: 33%;
        flex: 1 1 180px;
        display: block;
        position: relative;
        object-fit: cover;
        border-radius: 1px;
    }
    
    .bookmark-description {
        color: rgba(55, 53, 47, 0.6);
        font-size: 0.75em;
        overflow: hidden;
        max-height: 4.5em;
        word-break: break-word;
    }
    
    .bookmark-href {
        font-size: 0.75em;
        margin-top: 0.25em;
    }
    
    .sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
    .code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
    .serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
    .mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
    .pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
    .pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
    .pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
    .pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
    .pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
    .pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
    .pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
    .pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
    .pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
    .pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
    .pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
    .pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
    .pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
    .pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
    .pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
    .pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
    .highlight-default {
        color: rgba(55, 53, 47, 1);
    }
    .highlight-gray {
        color: rgba(120, 119, 116, 1);
        fill: rgba(120, 119, 116, 1);
    }
    .highlight-brown {
        color: rgba(159, 107, 83, 1);
        fill: rgba(159, 107, 83, 1);
    }
    .highlight-orange {
        color: rgba(217, 115, 13, 1);
        fill: rgba(217, 115, 13, 1);
    }
    .highlight-yellow {
        color: rgba(203, 145, 47, 1);
        fill: rgba(203, 145, 47, 1);
    }
    .highlight-teal {
        color: rgba(68, 131, 97, 1);
        fill: rgba(68, 131, 97, 1);
    }
    .highlight-blue {
        color: rgba(51, 126, 169, 1);
        fill: rgba(51, 126, 169, 1);
    }
    .highlight-purple {
        color: rgba(144, 101, 176, 1);
        fill: rgba(144, 101, 176, 1);
    }
    .highlight-pink {
        color: rgba(193, 76, 138, 1);
        fill: rgba(193, 76, 138, 1);
    }
    .highlight-red {
        color: rgba(212, 76, 71, 1);
        fill: rgba(212, 76, 71, 1);
    }
    .highlight-gray_background {
        background: rgba(241, 241, 239, 1);
    }
    .highlight-brown_background {
        background: rgba(244, 238, 238, 1);
    }
    .highlight-orange_background {
        background: rgba(251, 236, 221, 1);
    }
    .highlight-yellow_background {
        background: rgba(251, 243, 219, 1);
    }
    .highlight-teal_background {
        background: rgba(237, 243, 236, 1);
    }
    .highlight-blue_background {
        background: rgba(231, 243, 248, 1);
    }
    .highlight-purple_background {
        background: rgba(244, 240, 247, 0.8);
    }
    .highlight-pink_background {
        background: rgba(249, 238, 243, 0.8);
    }
    .highlight-red_background {
        background: rgba(253, 235, 236, 1);
    }
    .block-color-default {
        color: inherit;
        fill: inherit;
    }
    .block-color-gray {
        color: rgba(120, 119, 116, 1);
        fill: rgba(120, 119, 116, 1);
    }
    .block-color-brown {
        color: rgba(159, 107, 83, 1);
        fill: rgba(159, 107, 83, 1);
    }
    .block-color-orange {
        color: rgba(217, 115, 13, 1);
        fill: rgba(217, 115, 13, 1);
    }
    .block-color-yellow {
        color: rgba(203, 145, 47, 1);
        fill: rgba(203, 145, 47, 1);
    }
    .block-color-teal {
        color: rgba(68, 131, 97, 1);
        fill: rgba(68, 131, 97, 1);
    }
    .block-color-blue {
        color: rgba(51, 126, 169, 1);
        fill: rgba(51, 126, 169, 1);
    }
    .block-color-purple {
        color: rgba(144, 101, 176, 1);
        fill: rgba(144, 101, 176, 1);
    }
    .block-color-pink {
        color: rgba(193, 76, 138, 1);
        fill: rgba(193, 76, 138, 1);
    }
    .block-color-red {
        color: rgba(212, 76, 71, 1);
        fill: rgba(212, 76, 71, 1);
    }
    .block-color-gray_background {
        background: rgba(241, 241, 239, 1);
    }
    .block-color-brown_background {
        background: rgba(244, 238, 238, 1);
    }
    .block-color-orange_background {
        background: rgba(251, 236, 221, 1);
    }
    .block-color-yellow_background {
        background: rgba(251, 243, 219, 1);
    }
    .block-color-teal_background {
        background: rgba(237, 243, 236, 1);
    }
    .block-color-blue_background {
        background: rgba(231, 243, 248, 1);
    }
    .block-color-purple_background {
        background: rgba(244, 240, 247, 0.8);
    }
    .block-color-pink_background {
        background: rgba(249, 238, 243, 0.8);
    }
    .block-color-red_background {
        background: rgba(253, 235, 236, 1);
    }
    .select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
    .select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
    .select-value-color-green { background-color: rgba(219, 237, 219, 1); }
    .select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
    .select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
    .select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
    .select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
    .select-value-color-red { background-color: rgba(255, 226, 221, 1); }
    .select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
    .select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
    
    .checkbox {
        display: inline-flex;
        vertical-align: text-bottom;
        width: 16;
        height: 16;
        background-size: 16px;
        margin-left: 2px;
        margin-right: 5px;
    }
    
    .checkbox-on {
        background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
    }
    
    .checkbox-off {
        background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
    }
        
    </style></head><body><article id="06976ae4-1c9d-4ae1-8cec-e8c565374486" class="page sans"><header><h1 class="page-title">ESE 519Moodlight</h1></header><div class="page-body"><p id="6dd08ca1-dee5-43ea-8de6-d719ef5e5ebf" class="">
    </p><figure id="6ab8500e-ede1-4ee6-9342-4e9ee44bc5c6" class="image"><a href="https://user-images.githubusercontent.com/114244957/210037409-66f8b48e-220a-4067-9869-5d23ebac4f38.png"><img src="https://user-images.githubusercontent.com/114244957/210037409-66f8b48e-220a-4067-9869-5d23ebac4f38.png"/></a></figure><h1 id="ee7b32de-a0a9-43e8-8a72-80effb304640" class="">Content</h1><nav id="42a08580-4605-4416-ad34-c71ed09c2991" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ee7b32de-a0a9-43e8-8a72-80effb304640">Content</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#def3bf83-6068-41a0-aca5-8a4b5fbdad94"><mark class="highlight-orange">Team overview</mark></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2930b246-fc81-4260-8803-d50fe7cfff38"><mark class="highlight-orange">Project Showcase</mark></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a0ea8e26-4590-4f0e-8dbf-da93006c8371"><mark class="highlight-orange">Project instructions</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#7699a9d2-b004-448f-9f0b-d440a843c6a7"><mark class="highlight-teal">Components:</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#894d0e98-20a1-4eec-9563-b394ec754b4c"><mark class="highlight-teal">Block diagram:</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#16383d72-192c-481d-ad6c-21a137b847cd"><mark class="highlight-teal">Connection diagram:</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#e81fee9f-207f-4f64-97a0-668af635301b"><mark class="highlight-teal">Development environment</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#55207dc5-0fa9-47f8-b027-9292f0028d9c"><mark class="highlight-teal">Links to codes</mark></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#5d5d7486-9565-4cb0-908a-2a22569b90b6"><mark class="highlight-orange">Project development</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#68f780c8-ad9f-458c-948d-c0b9215bf33d"><mark class="highlight-teal">Kick-off</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#c53a5dd6-b766-4a80-8d92-6503cd1b9891"><mark class="highlight-teal">Midpoint Checkup</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11d99433-04f0-4252-aad4-c6feedd1b2ac"><mark class="highlight-teal">Final Design</mark></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#16073688-746b-4f46-9d34-807b1f19732a"><mark class="highlight-orange">Reflections</mark></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#8a8521c6-fad0-43ca-8068-1c808a8a3786"><mark class="highlight-orange">Feature Highlights</mark></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#1e4c4e99-55ec-4753-9a81-7b9b641d5bdc"><mark class="highlight-orange">PIO in use</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#392741e3-fbe1-40a1-bdc4-6a24888be5f3"><mark class="highlight-teal">Diagram of the overall logic</mark></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#34a5e1dd-f3cc-472d-a649-da5fcbd99246"><mark class="highlight-teal">Introduction to the RP2040 PIO module</mark></a></div></nav><h2 id="def3bf83-6068-41a0-aca5-8a4b5fbdad94" class=""><mark class="highlight-orange">Team overview</mark></h2><p id="91ba575c-bee8-4050-b0a1-ec8f89a560c4" class="">Click little triangles for more details.</p><ul id="8a1359d6-b0fb-45a5-b6ad-00573b5be934" class="toggle"><li><details open=""><summary>Katrina Ji</summary><p id="1c63cbca-2bca-4833-b9f0-22b4bde09797" class="">Github: </p><figure id="1cb9147a-215d-4949-8ac0-630b94c35da5"><a href="https://github.com/katrinaji" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">katrinaji - Overview</div><div class="bookmark-description">You can&#x27;t perform that action at this time. You signed in with another tab or window. You signed out in another tab or window. Reload to refresh your session. Reload to refresh your session.</div></div><div class="bookmark-href"><img src="https://github.com/favicon.ico" class="icon bookmark-icon"/>https://github.com/katrinaji</div></div><img src="https://avatars.githubusercontent.com/u/114244957?v=4?s=400" class="bookmark-image"/></a></figure><p id="b5075c42-08ee-48fe-a0d3-a76c616d2b46" class="">Email: katji@seas.upenn.edu</p></details></li></ul><ul id="6be48428-ecdf-4632-872e-c4452adfefaa" class="toggle"><li><details open=""><summary>Yuchen Wang</summary><p id="59610d50-0793-4e86-b470-57e821fffe83" class="">Github:</p><figure id="b40c7278-4dd2-47e2-bb3d-01194e785e39"><a href="https://github.com/YuchenWang0303" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">YuchenWang0303 - Overview</div><div class="bookmark-description">You can&#x27;t perform that action at this time. You signed in with another tab or window. You signed out in another tab or window. Reload to refresh your session. Reload to refresh your session.</div></div><div class="bookmark-href"><img src="https://github.com/favicon.ico" class="icon bookmark-icon"/>https://github.com/YuchenWang0303</div></div><img src="https://avatars.githubusercontent.com/u/105755054?v=4?s=400" class="bookmark-image"/></a></figure><p id="9fbdbad2-c7a4-4996-ac6a-ae27286a4cf7" class="">Email: wangybv@seas.upenn.edu</p></details></li></ul><ul id="dcc24690-8b5a-4b33-8281-56a5c1445b73" class="toggle"><li><details open=""><summary>Chongyang Zhang</summary><p id="3791d96e-9604-492e-a911-615ab6406fd3" class="">Github:</p><figure id="9c40066b-2673-410b-bf04-f4d6326285bd"><a href="https://github.com/Ryan66666" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Ryan66666 - Overview</div><div class="bookmark-description">You can&#x27;t perform that action at this time. You signed in with another tab or window. You signed out in another tab or window. Reload to refresh your session. Reload to refresh your session.</div></div><div class="bookmark-href"><img src="https://github.com/favicon.ico" class="icon bookmark-icon"/>https://github.com/Ryan66666</div></div><img src="https://avatars.githubusercontent.com/u/114255407?v=4?s=400" class="bookmark-image"/></a></figure><p id="dc3d1f48-65d2-485a-a033-44fa358e1c53" class="">Email: zcy6@seas.upenn.edu</p></details></li></ul><hr id="af12b0c6-615e-410a-92f0-cefa86ea6f03"/><h2 id="2930b246-fc81-4260-8803-d50fe7cfff38" class=""><mark class="highlight-orange">Project Showcase</mark></h2><p id="a2935d4b-83ec-4e4c-9dba-5132d5903c41" class="">Our team aims to invent a sensing device that will measure the in-room apparent temperature by detecting room temperature and humidity. The user can customize their favorite display mode. The device has five modes:</p><div id="d0ebff8f-a3f7-455f-85bb-d0f92506dda2" class="column-list"><div id="c2ced3b4-55cb-4022-966e-2f4fadbec433" style="width:50%" class="column"><ul id="791c7d2b-9c30-45dc-a510-f5e07ce64e77" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-yellow_background">Mode TMEP: shows the room temperature</mark></li></ul><ul id="f0408921-0ead-48cd-9fac-9166225151ae" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-yellow_background">Mode RHUM: shows the room relative humidity</mark></li></ul><ul id="28a17b26-f5a5-4eac-aaf4-eaa9883c65de" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-yellow_background">Mode FEEL: shows the in-room apparent temperature, i.e. how your body feels in the room </mark></li></ul><ul id="d1f959f3-ff50-413c-b134-98af085a2762" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-yellow_background">Mode FACE: shows either a smiling or crying face based on temperature and humidity, can be customized by the user </mark></li></ul></div><div id="6fbfe2b0-55e7-4033-a4a6-7c1f80679151" style="width:50%" class="column"><ul id="f7d43f21-b080-4de0-8c24-9e935970ae01" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-yellow_background">Mode RAINBOW: shows a heat index map across all the measuring range for the sensor and indicate the “location” of the current measurements </mark></li></ul><ul id="cca629d5-0d6c-486f-ba6d-f3f1c71e4949" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-yellow_background">Mode ROLL: shows all the five modes in a rolling sequence</mark></li></ul><p id="ca06e433-2fcb-4a14-b17c-33a95b8766d7" class="">
    </p></div></div><p id="57816a20-27b7-4f1b-a7b9-37050b8a0a50" class="">All of the indications are presented on a 16x32 RGB LED matrix panel. The device is also equipped with a person detection function. Whenever a human is in the vision area of the camera, the panel will be changed to a user’s preferred mode. For example, if the user prefers to see the RAINBOW mode, he/she will set the mode to their prefer mode first. The next time when he/she reads the the panel, the camera will detect human activity and change the display to RAINBOW mode until they leave.</p><div id="eab000a9-9313-4b9c-9b2e-243151e10b86" class="column-list"><div id="3cc8b8a9-d220-4a98-8405-e7aff7442cc1" style="width:50%" class="column"><figure id="89a630d9-61e0-41b3-a5ec-c3985d88e365" class="image"><a href="https://user-images.githubusercontent.com/105755054/209399661-72d4c804-97a8-429d-8177-e13ec1642303.JPG"><img src="https://user-images.githubusercontent.com/105755054/209399661-72d4c804-97a8-429d-8177-e13ec1642303.JPG"/></a></figure><p id="ad22f48d-f9ca-4fbb-a337-ef3c47e42120" class="">Mode TEMP</p></div><div id="e67000dc-5d48-4487-82f8-f7243f7d3ba8" style="width:50%" class="column"><figure id="d69086e1-df48-443a-bfba-2d8ae0fd8be3" class="image" style="text-align:center"><a href="https://user-images.githubusercontent.com/105755054/209399679-f63e8f3c-6dd7-4774-b391-c7e45855b4cc.JPG"><img style="width:432px" src="https://user-images.githubusercontent.com/105755054/209399679-f63e8f3c-6dd7-4774-b391-c7e45855b4cc.JPG"/></a><figcaption><mark class="highlight-gray">Mode RHUM</mark></figcaption></figure></div></div><div id="4dff795b-3ae8-4b15-8ad8-bcdc99edb4eb" class="column-list"><div id="91c79aa2-8f02-4546-a39c-8d34f8b2f9a8" style="width:50%" class="column"><figure id="5fb8dc3b-c670-47ae-a81f-68b8ca8d7093" class="image"><a href="https://user-images.githubusercontent.com/105755054/209399670-80a55a39-d921-40ad-bdda-d567670175ac.JPG"><img src="https://user-images.githubusercontent.com/105755054/209399670-80a55a39-d921-40ad-bdda-d567670175ac.JPG"/></a><figcaption>Mode FEEL</figcaption></figure></div><div id="962db207-c1cd-4991-8f2a-7c3aaa49cafd" style="width:50%" class="column"><figure id="c32951c7-286a-4585-85ae-2fe171586f4f" class="image"><a href="https://user-images.githubusercontent.com/105755054/209399728-d41d9359-d014-4621-a9dd-84a485e6c4e3.JPG"><img src="https://user-images.githubusercontent.com/105755054/209399728-d41d9359-d014-4621-a9dd-84a485e6c4e3.JPG"/></a><figcaption>Mode FACE</figcaption></figure></div></div><figure id="47cafea2-8e2f-40c0-848c-4c3eaf3c84fb" class="image"><a href="https://user-images.githubusercontent.com/105755054/209399611-c63fcece-f27d-4203-9335-e9cd4a059b81.JPG"><img src="https://user-images.githubusercontent.com/105755054/209399611-c63fcece-f27d-4203-9335-e9cd4a059b81.JPG"/></a><figcaption>Mode RAINBOW</figcaption></figure><p id="d145b1ae-cc6d-45c1-b90f-6c64be600294" class="">A brief introduction <a href="https://youtu.be/Q91RQ9lhCjs">video</a>.</p><h2 id="a0ea8e26-4590-4f0e-8dbf-da93006c8371" class=""><mark class="highlight-orange">Project instructions</mark></h2><h3 id="7699a9d2-b004-448f-9f0b-d440a843c6a7" class=""><mark class="highlight-teal">Components:</mark></h3><ul id="e96057cb-bfaf-4aad-9982-3cfd3a1b0df4" class="bulleted-list"><li style="list-style-type:disc">Pico4ML</li></ul><ul id="b2ce7995-45cf-4b68-896e-9a4a7b0a7395" class="bulleted-list"><li style="list-style-type:disc">PC/Laptop as REPL screen (Can be removed in real life application)</li></ul><ul id="3aea7805-40fd-4540-98c8-f180cb37344a" class="bulleted-list"><li style="list-style-type:disc">Adafruit SHT40</li></ul><ul id="8a4afcc7-1cba-416e-8e5f-39859361022d" class="bulleted-list"><li style="list-style-type:disc">Adafruit Perma-Proto Half-sized Breadboard PCB</li></ul><ul id="abc43e66-6045-4843-af2e-452d82dd542c" class="bulleted-list"><li style="list-style-type:disc">Adafruit QT-PY 2040</li></ul><ul id="d1ac0e67-f753-4b40-a194-fe4386d8ec5c" class="bulleted-list"><li style="list-style-type:disc">16x32 RGB LED matrix panel</li></ul><ul id="dcad4d11-a988-444a-acd7-5c9c1a8c7d71" class="bulleted-list"><li style="list-style-type:disc">Arduino Uno Rev3</li></ul><h3 id="894d0e98-20a1-4eec-9563-b394ec754b4c" class=""><mark class="highlight-teal">Block diagram:</mark></h3><figure id="f69f4a74-4359-484f-87f6-ccad2c3f09d5" class="image"><a href="https://user-images.githubusercontent.com/114244957/209054737-e132e7d7-39e1-4b68-8af5-1b68817cdfec.png"><img src="https://user-images.githubusercontent.com/114244957/209054737-e132e7d7-39e1-4b68-8af5-1b68817cdfec.png"/></a><figcaption>System <mark class="highlight-gray">Block Diagram</mark></figcaption></figure><h3 id="16383d72-192c-481d-ad6c-21a137b847cd" class=""><mark class="highlight-teal">Connection diagram:</mark></h3><figure id="35a1975c-1f7b-4331-b48a-82c99deca94b" class="image"><a href="https://user-images.githubusercontent.com/114244957/210038095-91d749de-a1d0-4a9c-b667-0490e970d384.png"><img src="https://user-images.githubusercontent.com/114244957/210038095-91d749de-a1d0-4a9c-b667-0490e970d384.png"/></a><figcaption>Connection Diagram between Main QTPY 2040 board and Pico4ML (for Person Detection)</figcaption></figure><figure id="08aa1367-d6a5-4b24-a908-b0d729ae56b1" class="image"><a href="https://user-images.githubusercontent.com/114244957/210038099-a5e1e9bc-2d51-4218-a9d0-3027a37649e9.png"><img src="https://user-images.githubusercontent.com/114244957/210038099-a5e1e9bc-2d51-4218-a9d0-3027a37649e9.png"/></a><figcaption>Connection Diagram Between LED and Arduino</figcaption></figure><h3 id="e81fee9f-207f-4f64-97a0-668af635301b" class=""><mark class="highlight-teal">Development environment</mark></h3><ul id="3a3b1e3c-ef5c-4c14-92b1-c5223600d154" class="bulleted-list"><li style="list-style-type:disc">Visual Studio Code Version: 1.74.2</li></ul><ul id="060bb79a-05d6-4b07-8da3-f02317712f28" class="bulleted-list"><li style="list-style-type:disc">Visual Studio Code Version: 1.73.1</li></ul><pre id="40912d9e-dd33-44e8-9ede-8676e7a7558c" class="code code-wrap"><code>Test on: MacBook Pro (14-inch, 2021)
    
    Software: macOS Monterey 12.6</code></pre><ul id="b849cc63-a1ab-479a-88e4-a1643bc24abd" class="bulleted-list"><li style="list-style-type:disc">Arduino IDE Version: 1.8.20</li></ul><pre id="b7aff8fb-1653-40a4-9aff-6c85f5d4f9b9" class="code code-wrap"><code>Test on: MacBook Pro (14-inch, 2021)
    
    Software: macOS Monterey 12.6</code></pre><h3 id="55207dc5-0fa9-47f8-b027-9292f0028d9c" class=""><mark class="highlight-teal">Links to codes</mark></h3><p id="d4b20ea0-6db8-4cb2-991c-152a2d5d3690" class="">See Team <a href="https://github.com/519Moodlight/519Moodlight.github.io.git">REPO</a>.</p><h2 id="5d5d7486-9565-4cb0-908a-2a22569b90b6" class=""><mark class="highlight-orange">Project development</mark></h2><h3 id="68f780c8-ad9f-458c-948d-c0b9215bf33d" class=""><mark class="highlight-teal">Kick-off</mark></h3><p id="fe58bedf-9f7a-4fbe-b7e4-1215fd1eb067" class="">This the the team’s initial proposal slideshow. A detailed description about the project is shown in the video. https://docs.google.com/presentation/d/1t87cv9p3CeJUlsETCPSfEi2vsW76WDrAiFLQtDDplcw/edit?usp=sharing https://youtu.be/xyOEmyO56Lc</p><h3 id="c53a5dd6-b766-4a80-8d92-6503cd1b9891" class=""><mark class="highlight-teal">Midpoint Checkup</mark></h3><p id="92b81fda-b27f-45eb-9b6d-0dd0f25a3a3b" class="">This the the team’s midpoint checkup slideshow. It is for internal use during the development of the project. https://docs.google.com/presentation/d/15bB733aYIH5O1ynS-uNRryCd-YGT2AP3RCA227Z42LM/edit?usp=sharing</p><p id="a45f8961-390c-460b-a821-cda4fceef510" class="">The team has setup four midpoint checks to ensure that the team have a right pace in the project. The four checkpoint items are: - Pico4ML is able to perform person detection and return signals. - Adafruit SHT40 is able to return humidity and temperature values. - LCD can communicate with RP2040. - Some kind of REPL that returns sensor data.</p><p id="4df3c311-5cce-41fb-af5a-b11cceef4f91" class="">In the midpoint check, the team has successfully performed person detection in Pico4ML. Pico4ML produces a “person score” that shows if the detected object is a person. The score range from negative to positive. When the score is over 90, the detected object is a person. Usually, a human in a good light and background environment will get a score at around 110. The team was thinking to use I2C to directly transfer this “person score” to RP2040. RP2040 will do the calculation.</p><p id="c277a895-70de-45fa-9477-c32063e84848" class="">The team has also successfully perform humidity and temperature detection in SHT40. The sensor can have a directly communication with the RP2040 using PIO. More detailed description about using PIO is discussed in the later section. However, the team realized that using a LCD as the display cannot give out the most information. Since our project highly rely on the heat index map (shown below). Our instructor gave the advice that the team should implement the heat map to the display. LCD would not be sufficient. Thus, after discussion, the team has decided to use a 16x32 RGB LED matrix panel as the final display.</p><figure id="052062d4-af7b-40b3-8339-95e81a531f88" class="image"><a href="https://user-images.githubusercontent.com/114244957/209482149-3001af36-f5fa-468c-a7f0-c49ae5233d5d.png"><img src="https://user-images.githubusercontent.com/114244957/209482149-3001af36-f5fa-468c-a7f0-c49ae5233d5d.png"/></a><figcaption>Heat Index Mapping (<a href="https://www.researchgate.net/figure/HUMIDEX-scores-by-air-temperature-o-C-and-relative-humidity-source_fig1_29462712">Online source)</a></figcaption></figure><p id="8e7bb5dc-842a-4a2b-9f22-7868f25eefe8" class="">The team always had REPL to indicate the chip process and data return.</p><h3 id="11d99433-04f0-4252-aad4-c6feedd1b2ac" class=""><mark class="highlight-teal">Final Design</mark></h3><p id="fb1a0524-4c4c-4732-b01b-52fe3a9d5bf2" class="">This is the team’s final demo day slideshow. It was initially in slides. During the demo day, it was changed to a single page poster. https://docs.google.com/presentation/d/1gsq2rLiZDhrBSmuCHu-VE6WdknTC6gEK/edit?usp=sharing&amp;ouid=117714499329064750219&amp;rtpof=true&amp;sd=true</p><p id="220ae48a-df65-43d6-87e9-e1eb203bb2c3" class="">After a more detailed look at the RP2040 pins, the team realized that they don’t have enough pins to achieve more complex communication. Thus, the team has simplified the communication method. Instead of using I2C to communicate between Pico4ML and RP2040, the team has chosen to use GPIO high and low voltage as the signal.</p><p id="91431043-b145-4c34-977c-ed0c70ae0df4" class="">During the final stage, the team ensured that all the modules are working individually. The team’s main focus was on the communication. The team’s initial plan was to use two QTPY boards to communicate. One would be responsible for getting the sensor data, the other would be the MAIN board that collects all the information and integrate the together. After discussion, the team realized that one single board can finish all the work. Since the communication process has been simplified, Pico4ML and QTPY will only communicate using one GPIO pin. The new RGB LED matrix will have to use an Arduino board. The communication between Arduino and QTPY is UART.</p><h2 id="16073688-746b-4f46-9d34-807b1f19732a" class=""><mark class="highlight-orange">Reflections</mark></h2><p id="0059d1f4-23d0-4080-93ee-1e23dc7e4af5" class="">Design &amp; components selection The team’s initial design is to use two QTPY 2040 and one Pico4ML. It was designed so that the project would be highly “modulated”. Each teammate could work on their own component without interference. However, this design would require a lot of communication among three boards. The power consumption would also be high. During project development, the team has changed their strategy to integrate all functions to as few hardware as possible. There are two reasons:</p><ol type="1" id="a5c6bd34-79e9-41a6-adbc-63198601ddec" class="numbered-list" start="1"><li>The team has change from LCD display to a larger LED display. The larger LED display will be more visible from long distance and contains more information. To implement the display, the team used an Arduino Uno Rev3. This increased the number of boards in the system. Thus, the team decided to reduce one QTPY 2040 to simplify the system.</li></ol><ol type="1" id="0d6330ae-ae9b-4549-b537-43518332a5f0" class="numbered-list" start="2"><li>The device was designed to be mounted on the wall. The team would like to reduce the weight and size of the device to make it more compact.</li></ol><h2 id="8a8521c6-fad0-43ca-8068-1c808a8a3786" class=""><mark class="highlight-orange">Feature Highlights</mark></h2><ul id="d0076bfe-2cce-4142-a34a-b3f232b92536" class="bulleted-list"><li style="list-style-type:disc">Transfer Humidity and Temperature values in QTPY2040 to Arduino Uno Rev3 using UART UART needs two ports — TX and RX. The team picked port 20 and 5 as the UART ports on QTPY 2040 as recommended.<figure id="eda82a2d-78ac-4e12-9e93-eee0072851b6" class="image"><a href="https://user-images.githubusercontent.com/114244957/210037877-1ba00a3b-8046-4206-9eeb-247f92173d57.png"><img src="https://user-images.githubusercontent.com/114244957/210037877-1ba00a3b-8046-4206-9eeb-247f92173d57.png"/></a></figure></li></ul><pre id="9f73afdd-c4bd-42c5-8c02-7d287a602800" class="code code-wrap"><code>#define UART_TX_PIN 20 //UART TX1
    #define UART_RX_PIN 5 //UART RX1</code></pre><p id="c1078674-5385-4c14-96db-0e37ca8e128c" class="">The team picked port 12 and 13 as the TX and RX for Arduino. The communication protocol for our system is a string. For example, if the temperature is negative 9 degree calculus and humidity is 54%, the string will be STR-09H54M0FN . If the temperature is 23 degree calculus and humidity is 89%, the string will be STR 23H89M0FN . The meaning of M0 will be explained in the next.</p><pre id="fb06b8da-37dc-422c-b8fb-d4c55aecceb5" class="code code-wrap"><code>//Start forming a string
    strcat(str, &quot;STR&quot;);
    strcat(str, sign);
    if(temp &lt;= 9)
        strcat(str, &quot;0&quot;);
    strcat(str, stemp);
    strcat(str, &quot;H&quot;);
    if(hum &lt;= 9)
        strcat(str, &quot;0&quot;);
    strcat(str, shum);
    strcat(str, &quot;M&quot;);
    strcat(str, smode);
    strcat(str, &quot;FN&quot;);
    
    int32_t ustrlen;
    ustrlen = strlen(str);
    printf(&quot;%s, length is %d\n&quot;,str,ustrlen);
    printf(&quot;smode is %s\n&quot;, smode);
    
    //Uart Transmisstion
    uart_puts(UART_ID,str);
    //uart_puts(UART_ID,&quot;STR 42H95M4FN&quot;); // For direct testing
    sleep_ms(500);</code></pre><ul id="b789733d-f860-40d1-9969-9bed76e42b8e" class="bulleted-list"><li style="list-style-type:disc">Five-mode control for Display There are five modes for this device. 1) Temperature, 2) Humidity, 3) Feeling temperature, 4) Face visualization (specific face patterns), 5) Rainbow (10 colors to show different humidity and temperature). Every time the Mode button is pressed, the mode will increment by one.</li></ul><pre id="0b378eb6-6f56-4bc1-b543-4dd64ff9b0e0" class="code code-wrap"><code>//String Process about negative
    if(temp &lt; 0){
        sign = &quot;-&quot;;
        temp = -temp;
    }
    itoa(temp, stemp, 10);
    itoa(hum, shum, 10);
    printf(&quot;Input string: temp is %s, hum is %s.\n&quot;, stemp, shum);</code></pre><pre id="51a1df0e-f041-4cc5-bfe2-99fadceb4484" class="code code-wrap"><code>//If the mode button is pressed
    if(gpio_get(A0) ==1){
        printf(&quot;A0 is pressed.\n&quot;);
        switch (mcounter)
        {
        case 0:
            smode = &quot;0&quot;;
            printf(&quot;Case TEMP\n&quot;);
            mcounter ++;
            break;
        case 1:
            smode = &quot;1&quot;;
            printf(&quot;Case RHUM\n&quot;);
            mcounter ++;
            break;
        case 2:
            smode = &quot;2&quot;;
            printf(&quot;Case APPT\n&quot;);
            mcounter ++;
            break;
        case 3:
            smode = &quot;3&quot;;
            printf(&quot;Case FACE\n&quot;);
            mcounter ++;
            break;
        case 4:
            smode = &quot;4&quot;;
            printf(&quot;Case RAINBOW\n&quot;);
            mcounter ++;
            break;
        case 5:
            smode = &quot;5&quot;;
            printf(&quot;Case DEMO\n&quot;);
            mcounter = 0;
            break;
        default:
            break;
        }
    }</code></pre><ul id="adea8e5b-6eea-4740-a02b-8025408874a1" class="bulleted-list"><li style="list-style-type:disc">Temperature and Humidity adjustment for DEMO. Since the team would like to present all of the functions of the device, two extra buttons have been added. In this way, the temperature and humidity can be manually set for demo use.</li></ul><pre id="92d78bb7-145d-4692-9d33-3e64e659a0ec" class="code code-wrap"><code>//For demo use, initilize temp and hum
    int32_t temp_stp = 8;
    int32_t hum_stp = 6;
    int32_t temp_counter = 0;
    int32_t hum_counter = 0;
    
    //For demo
    if(gpio_get(A1) == 1){
        sleep_ms(250);
        if(temp_counter == 0){
            temp = -24;
        }
        temp = temp + temp_stp;
        temp_counter ++;
        if(temp &gt;= 44){
            temp_counter = 0;
            temp = 44;
        }
        printf(&quot;********************\nA1 is pressed. Set temperature to %d.\n&quot;, temp);
    }
    if(gpio_get(A2) == 1){
        sleep_ms(250);
        if(hum_counter == 0){
            hum = -5; //base
        }
        hum = hum + hum_stp;
        hum_counter ++;
        if(hum &gt;= 97){
            hum_counter = 0;
            hum = 97;
        }
        printf(&quot;********************\nA2 is pressed. Set humidity to %d.\n&quot;, hum);
    }</code></pre><h2 id="1e4c4e99-55ec-4753-9a81-7b9b641d5bdc" class=""><mark class="highlight-orange">PIO in use</mark></h2><ul id="c40cabb2-cf42-47d1-beeb-494ec40728b3" class="bulleted-list"><li style="list-style-type:disc">I2C communication protocol base on PIO</li></ul><ul id="872c5d1d-f3eb-4c86-b56b-26b8ee99c975" class="bulleted-list"><li style="list-style-type:disc">Basic Pseudo Code of SH4X Temp.&amp;Humidity Sensor with I2C Protocol</li></ul><figure id="ed632ef9-2426-4133-a590-47a700c6f5e8" class="image"><a href="https://user-images.githubusercontent.com/105755054/209400650-359622ef-bf4a-4e53-b3c9-4f99f7749005.png"><img src="https://user-images.githubusercontent.com/105755054/209400650-359622ef-bf4a-4e53-b3c9-4f99f7749005.png"/></a></figure><figure id="a9b079ac-80dd-455a-9ad1-b9e2b8df97c6" class="image"><a href="https://user-images.githubusercontent.com/105755054/209401537-53491948-e8ca-4f8b-a470-d835c4b929f1.png"><img src="https://user-images.githubusercontent.com/105755054/209401537-53491948-e8ca-4f8b-a470-d835c4b929f1.png"/></a></figure><ul id="ab8b9640-370d-4240-8f23-05fd406e8452" class="bulleted-list"><li style="list-style-type:disc">SHT4X Header</li></ul><pre id="645386d6-aa2b-4128-9c11-55857bd0bfb7" class="code code-wrap"><code>#ifndef SHT4X_H
    #define SHT4X_H
    
    #include &lt;stdio.h&gt;
    #include &quot;pico/stdlib.h&quot;
    #include &quot;pico/binary_info.h&quot;
    #include &quot;pio_i2c.h&quot;
    
    void read_temp_hum(int32_t *temp, int32_t *hum, PIO pio, uint sm, uint32_t addr);
    
    #endif
    </code></pre><ul id="d2f84f26-f6ef-4a1f-80d8-765f264e7697" class="bulleted-list"><li style="list-style-type:disc">SHT4X C code with Explanation</li></ul><pre id="eccd81df-d1c5-4e47-853b-1f9c636a0d26" class="code code-wrap"><code>#include &lt;stdio.h&gt;
    #include &quot;pico/stdlib.h&quot;
    #include &quot;pico/binary_info.h&quot;
    #include &quot;pio_i2c.h&quot;
    #include &lt;math.h&gt;
    
    //enable the sensor and measure temp. and hum.
    #define INIT_CONFIG 0xFD
    
    //address of sht40
    const int addr = 0x44;
    #define SDA 22
    #define SCL 23
    
    //using PIO0 and SM0 as I2C trasimission
    PIO pio = pio0;
    uint sm = 0;
    
    void read_temp_hum(int32_t *temp, int32_t *hum, PIO pio, uint sm, uint32_t addr){
    
        //create an empty array for storing the starting-comment of SH4X
        uint8_t tx_bytes[1];
    
        //create an empty array for storing the data reading from the I2C data parts
        uint8_t data[6];
    
        //Transmit the starting comment to SH4X sensor via I2C writing
        tx_bytes[0] = INIT_CONFIG;
        pio_i2c_write_blocking(pio, sm, addr, tx_bytes, 1, true);
        sleep_ms(10);
    
        //Read data from the I2C slaver with 6 Bytes each period
        pio_i2c_read_blocking(pio, sm, addr, data, 6, false);
    
        //combine the raw-temperature data togeter
        int raw_temperature = data[0]*256 + data[1];
    
        //combine the raw-humidity data
        int raw_humidity = data[3]*256 + data[4];
    
        //covert the raw data to readable temperatire and humidity
        float termperature = ((175 * (raw_temperature/65536.00)) - 45.00);
        float humidity = ((125 * (raw_temperature/65536.00)) - 6.00);
    
        //return the termperture and humidity with integers
        *temp = termperature;
        *hum = humidity;
    }</code></pre><h3 id="392741e3-fbe1-40a1-bdc4-6a24888be5f3" class=""><mark class="highlight-teal">Diagram of the overall logic</mark></h3><ul id="29060462-fb77-45ed-9707-7c05e5d737ea" class="bulleted-list"><li style="list-style-type:disc">Functional Block Diagram of SH4X Sensor</li></ul><figure id="ff9b9c58-c459-4713-b179-9a10933ace53" class="image"><a href="https://user-images.githubusercontent.com/105755054/209403700-2b47f540-c5d8-4c41-a90c-52999b19417e.png"><img src="https://user-images.githubusercontent.com/105755054/209403700-2b47f540-c5d8-4c41-a90c-52999b19417e.png"/></a></figure><ul id="85cb12b2-256e-4f2b-b61b-14d5fcbc3e6d" class="bulleted-list"><li style="list-style-type:disc">QTPY2040 and SHT40 with I2C</li></ul><figure id="2252e189-c7d1-44fe-82a5-1305bd96d098" class="image"><a href="https://user-images.githubusercontent.com/105755054/209403649-c859e95d-843f-4192-a022-69d03cebf5af.png"><img src="https://user-images.githubusercontent.com/105755054/209403649-c859e95d-843f-4192-a022-69d03cebf5af.png"/></a></figure><h3 id="34a5e1dd-f3cc-472d-a649-da5fcbd99246" class=""><mark class="highlight-teal">Introduction to the RP2040 PIO module</mark></h3><p id="af870cce-aa40-4b78-ba29-af3942bad11e" class="">One unique feature of the RP2040 microcontroller from the Raspberry Pi Foundation is its Programmable I/O (PIO) peripheral. The focus of PIO is serial communication. Most microcontrollers have hardware support for popular serial protocols such as I²C, SPI, and UART. However, this hardware support is always limited both in the number of serial interfaces and the types of serial interfaces that can be used, such as Arduino uno Rev3 only having 1 UART port. If you have a non-standard serial interface you need to support, you may have to resort to bit-banging I/O pins to implement it, tying up the microcontroller core to get the timing right. PIO aims to solve this problem by providing a highly configurable, programmable I/O peripheral that will take care of the bit-banging and provide simple input and output FIFO queues to the microcontroller core.</p><p id="6897ab71-bad1-428b-bbad-e869aa7aaca3" class="">There are two PIO blocks with four state machines each, that can independently execute sequential programs to manipulate GPIOs and transfer data. Unlike a general-purpose processor, PIO state machines are highly specialized for IO, with a focus on determinism, precise timing, and close integration with fixed-function hardware. Each state machine and its supporting hardware occupy approximately the same silicon area as a standard serial interface block, such as an SPI or I2C controller. However, PIO state machines can be configured and reconfigured dynamically to implement numerous different interfaces.</p><p id="2060f12a-80d8-4025-b5af-bd7f841d4ce2" class="">In our project, we used PIO_I2C to replace the traditional I2C protocol. There are some PIO examples that we have modified to be able to use in our project.</p><pre id="494bf3d0-fad1-4325-bfba-572a1ca4f418" class="code code-wrap"><code>pio_i2c_write_blocking(pio, sm, addr, tx_bytes, 1, true);
    pio_i2c_read_blocking(pio, sm, addr, data, 6, false);</code></pre><p id="1fb56139-5a1d-4f68-a98c-15c262ff29c4" class="">
    </p></div></article></body></html>